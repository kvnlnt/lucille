var Tabulous=function(a){this.TUNING={GUITAR:{STANDARD:["e2","a2","d3","g3","b3","e4"]}};var b={};b.root="a",b.type="",b.tuning=this.TUNING.GUITAR.STANDARD,b.frets=24,b.span=5,this.settings=_.extend({},b,a),this.setUp()};Tabulous.prototype.getTuning=function(){var a=function(a){return teoria.note(a)},b=_.map(this.settings.tuning,a);return b},Tabulous.prototype.getBoard=function(){var a=this.tuning,b=[];return _.times(this.settings.frets,function(c){b[c]=[],_.each(a,function(a,d){var e=teoria.note.fromKey(a.key()+c);b[c][d]=e})}),b},Tabulous.prototype.getChord=function(){var a=teoria.note(this.settings.root).chord(this.settings.type);return a},Tabulous.prototype.getNotes=function(){var a=_.map(this.chord.notes(),function(a){return a});return a},Tabulous.prototype.getVoicings=function(a,b){var b=b||[],a=a||0,c=[],d=_.range(a,a+this.settings.span),e=this.tuning,f=_.map(this.notes,function(a){return a.name()+a.accidental()}),g=_.map(e,function(){return-1}),h=_.map(e,function(){return null});_.each(d,function(a){_.each(e,function(b,d){var e=teoria.note.fromKey(b.key()+a),i=e.enharmonics(!0).length?e.enharmonics(!0)[0].name()+e.enharmonics(!0)[0].accidental():"",j=e.name()+e.accidental(),k=_.contains(f,j)||_.contains(f,i),l=_.contains(c,d);!0===k&&!1===l&&(c.push(d),g[d]=a,h[d]=e)})});var i=_.chain(_.last(b)).compact().sortBy().last(),j=_.chain(g).compact().sortBy().last(),k=12>i&&j>12?12:j,l=a+this.settings.span<this.settings.frets;return b.push({voicing:g,data:h}),!0===l?this.getVoicings(k,b):b},Tabulous.prototype.setUp=function(){this.tuning=this.getTuning(),this.board=this.getBoard(),this.chord=this.getChord(),this.notes=this.getNotes(),this.voicings=this.getVoicings(0)},Tabulous.prototype.set=function(a,b){this.settings[a]=b,this.setUp()};